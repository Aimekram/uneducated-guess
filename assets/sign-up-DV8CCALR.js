import{r as h,j as a,L as p,A as b,a as x,b as g}from"./index-DLbGi-RN.js";import{u as w,e as c,T as d,p as m,c as u,z as j}from"./TextInput-RCtA0NSl.js";const v=j.object({email:c,password:m,confirmPassword:u}).refine(o=>o.password===o.confirmPassword,{message:"Passwords need to match",path:["confirmPassword"]}),f=({onSubmit:o,isLoading:t=!1})=>{const[i,l]=h.useState(null),r=w({validators:{onSubmit:v},defaultValues:{email:"",password:"",confirmPassword:""},onSubmit:async({value:e})=>{try{l(null),await o({email:e.email,password:e.password})}catch(s){if(s instanceof b){l("Couldn't sign you up, please refresh and try again");return}l("An unexpected error occurred, please refresh and try again")}}});return a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Create an account"}),i&&a.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4",children:a.jsx("p",{children:i})}),a.jsxs("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),r.validate("submit"),r.handleSubmit()},className:"flex flex-col gap-2",children:[a.jsx(r.Field,{name:"email",validators:{onBlur:c},children:e=>{var s,n;return a.jsx(d,{label:"Email",placeholder:"your-email@example.com",type:"email",field:{name:e.name,value:e.state.value,handleChange:e.handleChange,handleBlur:e.handleBlur},errorMsg:(n=(s=e.state.meta.errors)==null?void 0:s[0])==null?void 0:n.message,isDisabled:t})}}),a.jsx(r.Field,{name:"password",validators:{onBlur:m},children:e=>{var s,n;return a.jsx(d,{label:"Password",placeholder:"Password",type:"password",field:{name:e.name,value:e.state.value,handleChange:e.handleChange,handleBlur:e.handleBlur},errorMsg:(n=(s=e.state.meta.errors)==null?void 0:s[0])==null?void 0:n.message,isDisabled:t})}}),a.jsx(r.Field,{name:"confirmPassword",validators:{onBlur:u},children:e=>{var s,n;return a.jsx(d,{label:"Confirm Password",placeholder:"Confirm Password",type:"password",field:{name:e.name,value:e.state.value,handleChange:e.handleChange,handleBlur:e.handleBlur},errorMsg:(n=(s=e.state.meta.errors)==null?void 0:s[0])==null?void 0:n.message,isDisabled:t})}}),a.jsx("div",{className:"mt-2",children:a.jsx(r.Subscribe,{selector:e=>[e.canSubmit,e.isSubmitting],children:([e,s])=>a.jsx("button",{type:"submit",disabled:!e||t,className:"w-full bg-blue-500 text-white rounded p-2 hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Creating account...":"Create account"})})}),a.jsxs("p",{className:"text-sm text-center mt-4 text-gray-600",children:["Already have an account?"," ",a.jsx(p,{to:"/sign-in",className:"text-blue-600 hover:underline",children:"Sign in"})]})]})]})},C=function(){const t=x(),i=async({email:l,password:r})=>{const{error:e}=await g.signUp(l,r);if(e)throw e;t({to:"/sign-in",search:{message:"sign-up-success"}})};return a.jsx(f,{onSubmit:i})};export{C as component};
